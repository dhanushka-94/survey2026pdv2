{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/lib/supabase/admin.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\n\nif (!supabaseUrl || !supabaseServiceRoleKey) {\n  throw new Error('Missing Supabase service role environment variables');\n}\n\n// Admin client with service role key (bypasses RLS)\n// Use ONLY in server-side code, NEVER expose to client\nexport const supabaseAdmin = createClient(supabaseUrl, supabaseServiceRoleKey, {\n  auth: {\n    persistSession: false,\n    autoRefreshToken: false,\n  },\n});\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM,yBAAyB,QAAQ,GAAG,CAAC,yBAAyB;AAEpE,IAAI,CAAC,eAAe,CAAC,wBAAwB;IAC3C,MAAM,IAAI,MAAM;AAClB;AAIO,MAAM,gBAAgB,IAAA,8LAAY,EAAC,aAAa,wBAAwB;IAC7E,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;IACpB;AACF"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/actions/surveys.ts"],"sourcesContent":["'use server';\n\nimport { revalidatePath } from 'next/cache';\nimport { supabaseAdmin } from '@/lib/supabase/admin';\nimport type { Survey, SurveyFormData } from '@/lib/types';\n\nexport async function getSurveys() {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .select(`\n        *,\n        categories (count),\n        questions (count),\n        responses (count)\n      `)\n      .order('created_at', { ascending: false });\n\n    if (error) throw error;\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Get surveys error:', error);\n    return { success: false, error: 'Failed to fetch surveys' };\n  }\n}\n\nexport async function getSurvey(id: string) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .select(`\n        *,\n        categories (\n          *,\n          questions (*)\n        )\n      `)\n      .eq('id', id)\n      .single();\n\n    if (error) throw error;\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Get survey error:', error);\n    return { success: false, error: 'Failed to fetch survey' };\n  }\n}\n\nexport async function createSurvey(formData: SurveyFormData) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .insert([\n        {\n          title: formData.title,\n          description: formData.description || null,\n          is_active: formData.is_active,\n          start_date: formData.start_date || null,\n          end_date: formData.end_date || null,\n        },\n      ])\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    return { success: true, data };\n  } catch (error) {\n    console.error('Create survey error:', error);\n    return { success: false, error: 'Failed to create survey' };\n  }\n}\n\nexport async function updateSurvey(id: string, formData: Partial<SurveyFormData>) {\n  try {\n    const updateData: any = {};\n    \n    if (formData.title !== undefined) updateData.title = formData.title;\n    if (formData.description !== undefined) updateData.description = formData.description || null;\n    if (formData.is_active !== undefined) updateData.is_active = formData.is_active;\n    if (formData.start_date !== undefined) updateData.start_date = formData.start_date || null;\n    if (formData.end_date !== undefined) updateData.end_date = formData.end_date || null;\n\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .update(updateData)\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    revalidatePath(`/[admin]/surveys/${id}`);\n    return { success: true, data };\n  } catch (error) {\n    console.error('Update survey error:', error);\n    return { success: false, error: 'Failed to update survey' };\n  }\n}\n\nexport async function deleteSurvey(id: string) {\n  try {\n    const { error } = await supabaseAdmin\n      .from('surveys')\n      .delete()\n      .eq('id', id);\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    return { success: true };\n  } catch (error) {\n    console.error('Delete survey error:', error);\n    return { success: false, error: 'Failed to delete survey' };\n  }\n}\n\nexport async function toggleSurveyStatus(id: string, isActive: boolean) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .update({ is_active: isActive })\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    return { success: true, data };\n  } catch (error) {\n    console.error('Toggle survey status error:', error);\n    return { success: false, error: 'Failed to toggle survey status' };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/actions/questions.ts"],"sourcesContent":["'use server';\n\nimport { revalidatePath } from 'next/cache';\nimport { supabaseAdmin } from '@/lib/supabase/admin';\nimport type { QuestionFormData } from '@/lib/types';\n\nexport async function getQuestions(surveyId: string) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('questions')\n      .select(`\n        *,\n        category:categories(*)\n      `)\n      .eq('survey_id', surveyId)\n      .order('order_index', { ascending: true });\n\n    if (error) throw error;\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Get questions error:', error);\n    return { success: false, error: 'Failed to fetch questions' };\n  }\n}\n\nexport async function getQuestion(id: string) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('questions')\n      .select(`\n        *,\n        category:categories(*)\n      `)\n      .eq('id', id)\n      .single();\n\n    if (error) throw error;\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Get question error:', error);\n    return { success: false, error: 'Failed to fetch question' };\n  }\n}\n\nexport async function createQuestion(formData: QuestionFormData) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('questions')\n      .insert([\n        {\n          survey_id: formData.survey_id,\n          category_id: formData.category_id || null,\n          question_text: formData.question_text,\n          description: formData.description || null,\n          media_url: formData.media_url || null,\n          question_type: formData.question_type,\n          order_index: formData.order_index,\n        },\n      ])\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath(`/[admin]/surveys/${formData.survey_id}`);\n    return { success: true, data };\n  } catch (error) {\n    console.error('Create question error:', error);\n    return { success: false, error: 'Failed to create question' };\n  }\n}\n\nexport async function updateQuestion(id: string, formData: Partial<QuestionFormData>) {\n  try {\n    const updateData: any = {};\n    \n    if (formData.question_text !== undefined) updateData.question_text = formData.question_text;\n    if (formData.description !== undefined) updateData.description = formData.description || null;\n    if (formData.media_url !== undefined) updateData.media_url = formData.media_url || null;\n    if (formData.question_type !== undefined) updateData.question_type = formData.question_type;\n    if (formData.category_id !== undefined) updateData.category_id = formData.category_id || null;\n    if (formData.order_index !== undefined) updateData.order_index = formData.order_index;\n\n    const { data, error } = await supabaseAdmin\n      .from('questions')\n      .update(updateData)\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath(`/[admin]/surveys`);\n    return { success: true, data };\n  } catch (error) {\n    console.error('Update question error:', error);\n    return { success: false, error: 'Failed to update question' };\n  }\n}\n\nexport async function deleteQuestion(id: string, surveyId: string) {\n  try {\n    const { error } = await supabaseAdmin\n      .from('questions')\n      .delete()\n      .eq('id', id);\n\n    if (error) throw error;\n\n    revalidatePath(`/[admin]/surveys/${surveyId}`);\n    return { success: true };\n  } catch (error) {\n    console.error('Delete question error:', error);\n    return { success: false, error: 'Failed to delete question' };\n  }\n}\n\nexport async function uploadMedia(file: File): Promise<{ success: boolean; url?: string; error?: string }> {\n  try {\n    // Generate unique filename\n    const fileExt = file.name.split('.').pop();\n    const fileName = `${Date.now()}_${Math.random().toString(36).substring(7)}.${fileExt}`;\n    \n    // Upload to Supabase Storage\n    const { data, error } = await supabaseAdmin.storage\n      .from('survey-media')\n      .upload(fileName, file, {\n        cacheControl: '3600',\n        upsert: false,\n      });\n\n    if (error) throw error;\n\n    // Get public URL\n    const { data: urlData } = supabaseAdmin.storage\n      .from('survey-media')\n      .getPublicUrl(fileName);\n\n    return { success: true, url: urlData.publicUrl };\n  } catch (error) {\n    console.error('Upload media error:', error);\n    return { success: false, error: 'Failed to upload media' };\n  }\n}\n\nexport async function deleteMedia(url: string) {\n  try {\n    // Extract filename from URL\n    const filename = url.split('/').pop();\n    if (!filename) throw new Error('Invalid URL');\n\n    const { error } = await supabaseAdmin.storage\n      .from('survey-media')\n      .remove([filename]);\n\n    if (error) throw error;\n\n    return { success: true };\n  } catch (error) {\n    console.error('Delete media error:', error);\n    return { success: false, error: 'Failed to delete media' };\n  }\n}\n\nexport async function bulkImportQuestions(data: {\n  survey_id: string;\n  category_id: string;\n  question_type: string;\n  questions: string[];\n  start_order_index: number;\n}) {\n  try {\n    const { survey_id, category_id, question_type, questions, start_order_index } = data;\n\n    // Filter out empty lines and trim whitespace\n    const cleanedQuestions = questions\n      .map(q => q.trim())\n      .filter(q => q.length > 0);\n\n    if (cleanedQuestions.length === 0) {\n      return { success: false, error: 'No valid questions to import' };\n    }\n\n    // Create question records\n    const questionRecords = cleanedQuestions.map((question_text, index) => ({\n      survey_id,\n      category_id: category_id || null,\n      question_text,\n      description: null,\n      media_url: null,\n      question_type,\n      order_index: start_order_index + index,\n    }));\n\n    const { data: insertedData, error } = await supabaseAdmin\n      .from('questions')\n      .insert(questionRecords)\n      .select();\n\n    if (error) throw error;\n\n    revalidatePath(`/[admin]/surveys/${survey_id}`);\n    return { \n      success: true, \n      data: insertedData,\n      count: insertedData?.length || 0 \n    };\n  } catch (error) {\n    console.error('Bulk import questions error:', error);\n    return { success: false, error: 'Failed to import questions' };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/actions/categories.ts"],"sourcesContent":["'use server';\n\nimport { revalidatePath } from 'next/cache';\nimport { supabaseAdmin } from '@/lib/supabase/admin';\nimport type { CategoryFormData } from '@/lib/types';\n\nexport async function getCategories(surveyId: string) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('categories')\n      .select('*')\n      .eq('survey_id', surveyId)\n      .order('order_index', { ascending: true });\n\n    if (error) throw error;\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Get categories error:', error);\n    return { success: false, error: 'Failed to fetch categories' };\n  }\n}\n\nexport async function createCategory(formData: CategoryFormData) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('categories')\n      .insert([\n        {\n          survey_id: formData.survey_id,\n          name: formData.name,\n          order_index: formData.order_index,\n        },\n      ])\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath(`/[admin]/surveys/${formData.survey_id}`);\n    return { success: true, data };\n  } catch (error) {\n    console.error('Create category error:', error);\n    return { success: false, error: 'Failed to create category' };\n  }\n}\n\nexport async function updateCategory(id: string, formData: Partial<CategoryFormData>) {\n  try {\n    const updateData: any = {};\n    \n    if (formData.name !== undefined) updateData.name = formData.name;\n    if (formData.order_index !== undefined) updateData.order_index = formData.order_index;\n\n    const { data, error } = await supabaseAdmin\n      .from('categories')\n      .update(updateData)\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath(`/[admin]/surveys`);\n    return { success: true, data };\n  } catch (error) {\n    console.error('Update category error:', error);\n    return { success: false, error: 'Failed to update category' };\n  }\n}\n\nexport async function deleteCategory(id: string, surveyId: string) {\n  try {\n    const { error } = await supabaseAdmin\n      .from('categories')\n      .delete()\n      .eq('id', id);\n\n    if (error) throw error;\n\n    revalidatePath(`/[admin]/surveys/${surveyId}`);\n    return { success: true };\n  } catch (error) {\n    console.error('Delete category error:', error);\n    return { success: false, error: 'Failed to delete category' };\n  }\n}\n\nexport async function reorderCategories(\n  surveyId: string,\n  categories: { id: string; order_index: number }[]\n) {\n  try {\n    // Update all categories with new order\n    const updates = categories.map((cat) =>\n      supabaseAdmin\n        .from('categories')\n        .update({ order_index: cat.order_index })\n        .eq('id', cat.id)\n    );\n\n    await Promise.all(updates);\n\n    revalidatePath(`/[admin]/surveys/${surveyId}`);\n    return { success: true };\n  } catch (error) {\n    console.error('Reorder categories error:', error);\n    return { success: false, error: 'Failed to reorder categories' };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 563, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/.next-internal/server/app/%5Badmin%5D/surveys/%5Bid%5D/questions/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logoutAdmin as '0044c53403e3e6604193e2aa1c0d11d56084a09ed0'} from 'ACTIONS_MODULE0'\nexport {checkAdminSession as '00b5af0f019f07563997cf748ee8535a9b5066dce2'} from 'ACTIONS_MODULE0'\nexport {getAdminPath as '00e3fdbd53c91de81a3ecacf9c1bcec97e0f099327'} from 'ACTIONS_MODULE0'\nexport {loginAdmin as '4027a64e0dccf3631de50036c8fe6a8b8163861436'} from 'ACTIONS_MODULE0'\nexport {getSurveys as '00ee61176fd1ce9dd9bbe5ebcd46ef5009a2aeb479'} from 'ACTIONS_MODULE1'\nexport {createSurvey as '405b5c6f81d49ce5f4d5ac91c1a80fc9c41984ba0c'} from 'ACTIONS_MODULE1'\nexport {getSurvey as '409ea891199aef9c726d2008793c2f1494a2ea4528'} from 'ACTIONS_MODULE1'\nexport {deleteSurvey as '40a51905bbba375e10727af3af66eff74326aaf293'} from 'ACTIONS_MODULE1'\nexport {toggleSurveyStatus as '6058276b6aeea1adfddfc94ad1a11ced5f30bf9cad'} from 'ACTIONS_MODULE1'\nexport {updateSurvey as '60b32d01d78c3fbd5337100d854341b71b93d794d9'} from 'ACTIONS_MODULE1'\nexport {uploadMedia as '4004cdd95628b105e30275ce41ad6ae95621ceef86'} from 'ACTIONS_MODULE2'\nexport {createQuestion as '40501c750a2e4df480723a1a2aa078daf73f1469a7'} from 'ACTIONS_MODULE2'\nexport {bulkImportQuestions as '40534b527f7df28cae1d0759510187131c5909a7f7'} from 'ACTIONS_MODULE2'\nexport {getQuestions as '408f7ab6c1bdb6502bee9c9239c0992a0461e59f34'} from 'ACTIONS_MODULE2'\nexport {deleteMedia as '40eff2f7c9f01d91e110eac8d0f63b028776b2eb1f'} from 'ACTIONS_MODULE2'\nexport {getQuestion as '40fd37e11ec7da95f56026929cd0578043204dc97c'} from 'ACTIONS_MODULE2'\nexport {deleteQuestion as '608ba289557efdaadcef71ac6d21638dc036c0d573'} from 'ACTIONS_MODULE2'\nexport {updateQuestion as '60b99da49f46600ce1558790fcca53acd3146f052d'} from 'ACTIONS_MODULE2'\nexport {createCategory as '4063ad7326721af96ef7b3726d846e64d3807ce5b8'} from 'ACTIONS_MODULE3'\nexport {getCategories as '40721b0b34b99f1bb6814b9791dd876e3e70c72fdd'} from 'ACTIONS_MODULE3'\nexport {deleteCategory as '60117fc807b9f27d0a4a32b82b39dba6e5528ef196'} from 'ACTIONS_MODULE3'\nexport {updateCategory as '60d2a13d922f4e17d997840445563989816657ed32'} from 'ACTIONS_MODULE3'\nexport {reorderCategories as '60d5491057f4e142632a70830ca82867c59d4f10be'} from 'ACTIONS_MODULE3'\nexport {createQuestion as '40501c750a2e4df480723a1a2aa078daf73f1469a7'} from 'ACTIONS_MODULE2'\nexport {updateQuestion as '60b99da49f46600ce1558790fcca53acd3146f052d'} from 'ACTIONS_MODULE2'\nexport {deleteQuestion as '608ba289557efdaadcef71ac6d21638dc036c0d573'} from 'ACTIONS_MODULE2'\nexport {bulkImportQuestions as '40534b527f7df28cae1d0759510187131c5909a7f7'} from 'ACTIONS_MODULE2'\nexport {uploadMedia as '4004cdd95628b105e30275ce41ad6ae95621ceef86'} from 'ACTIONS_MODULE2'\nexport {deleteMedia as '40eff2f7c9f01d91e110eac8d0f63b028776b2eb1f'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":";AAAA;AAIA;AAMA;AAQA"}}]
}