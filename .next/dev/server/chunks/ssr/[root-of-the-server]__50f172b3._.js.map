{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n// Tailwind class name merger\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n// Format date for display\nexport function formatDate(date: string | Date): string {\n  const d = typeof date === 'string' ? new Date(date) : date;\n  return d.toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric'\n  });\n}\n\n// Format datetime for display\nexport function formatDateTime(date: string | Date): string {\n  const d = typeof date === 'string' ? new Date(date) : date;\n  return d.toLocaleString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit'\n  });\n}\n\n// Check if survey is currently active\nexport function isSurveyActive(\n  isActive: boolean,\n  startDate: string | null,\n  endDate: string | null\n): boolean {\n  if (!isActive) return false;\n\n  const now = new Date();\n\n  if (startDate && new Date(startDate) > now) {\n    return false;\n  }\n\n  if (endDate && new Date(endDate) < now) {\n    return false;\n  }\n\n  return true;\n}\n\n// Format time spent in seconds to readable format\nexport function formatTimeSpent(seconds: number): string {\n  if (seconds < 60) {\n    return `${seconds}s`;\n  }\n  const minutes = Math.floor(seconds / 60);\n  const remainingSeconds = seconds % 60;\n  return `${minutes}m ${remainingSeconds}s`;\n}\n\n// Generate session ID\nexport function generateSessionId(): string {\n  return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Get or create session ID from localStorage\nexport function getOrCreateSessionId(forceNew: boolean = false): string {\n  if (typeof window === 'undefined') return '';\n\n  const storageKey = 'survey_session_id';\n  \n  // If forceNew is true, always generate a new session ID\n  if (forceNew) {\n    const sessionId = generateSessionId();\n    localStorage.setItem(storageKey, sessionId);\n    return sessionId;\n  }\n\n  let sessionId = localStorage.getItem(storageKey);\n\n  if (!sessionId) {\n    sessionId = generateSessionId();\n    localStorage.setItem(storageKey, sessionId);\n  }\n\n  return sessionId;\n}\n\n// End current session (clear session ID)\nexport function endSession(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.removeItem('survey_session_id');\n}\n\n// Generate a new session ID and replace the old one\nexport function renewSessionId(): string {\n  endSession(); // First end the old session\n  return getOrCreateSessionId(true);\n}\n\n// Check if user has completed a survey\nexport function hasCompletedSurvey(surveyId: string): boolean {\n  if (typeof window === 'undefined') return false;\n\n  const completedSurveys = localStorage.getItem('completed_surveys');\n  if (!completedSurveys) return false;\n\n  const completed = JSON.parse(completedSurveys);\n  return completed.includes(surveyId);\n}\n\n// Mark survey as completed\nexport function markSurveyCompleted(surveyId: string): void {\n  if (typeof window === 'undefined') return;\n\n  const completedSurveys = localStorage.getItem('completed_surveys');\n  const completed = completedSurveys ? JSON.parse(completedSurveys) : [];\n\n  if (!completed.includes(surveyId)) {\n    completed.push(surveyId);\n    localStorage.setItem('completed_surveys', JSON.stringify(completed));\n  }\n}\n\n// Clear all completed surveys (useful for testing or allowing retakes)\nexport function clearCompletedSurveys(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.removeItem('completed_surveys');\n}\n\n// Clear specific survey completion (allow retake)\nexport function clearSurveyCompletion(surveyId: string): void {\n  if (typeof window === 'undefined') return;\n\n  const completedSurveys = localStorage.getItem('completed_surveys');\n  if (!completedSurveys) return;\n\n  const completed = JSON.parse(completedSurveys);\n  const filtered = completed.filter((id: string) => id !== surveyId);\n  localStorage.setItem('completed_surveys', JSON.stringify(filtered));\n}\n\n// Calculate percentage\nexport function calculatePercentage(value: number, total: number): number {\n  if (total === 0) return 0;\n  return Math.round((value / total) * 100);\n}\n\n// Validate file type for media upload\nexport function isValidMediaFile(file: File): boolean {\n  const validTypes = [\n    'image/jpeg',\n    'image/jpg',\n    'image/png',\n    'image/gif',\n    'image/webp',\n    'video/mp4',\n    'video/webm',\n    'video/quicktime'\n  ];\n  return validTypes.includes(file.type);\n}\n\n// Format file size\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];\n}\n\n// Get admin path from env\nexport function getAdminPath(): string {\n  return process.env.ADMIN_SECRET_PATH || 'admin-x9QpK7';\n}\n\n// Validate admin path in URL\nexport function isAdminPath(pathname: string): boolean {\n  const adminPath = getAdminPath();\n  return pathname.startsWith(`/${adminPath}`);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;;;AAGO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB;AAGO,SAAS,WAAW,IAAmB;IAC5C,MAAM,IAAI,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;IACtD,OAAO,EAAE,kBAAkB,CAAC,SAAS;QACnC,MAAM;QACN,OAAO;QACP,KAAK;IACP;AACF;AAGO,SAAS,eAAe,IAAmB;IAChD,MAAM,IAAI,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;IACtD,OAAO,EAAE,cAAc,CAAC,SAAS;QAC/B,MAAM;QACN,OAAO;QACP,KAAK;QACL,MAAM;QACN,QAAQ;IACV;AACF;AAGO,SAAS,eACd,QAAiB,EACjB,SAAwB,EACxB,OAAsB;IAEtB,IAAI,CAAC,UAAU,OAAO;IAEtB,MAAM,MAAM,IAAI;IAEhB,IAAI,aAAa,IAAI,KAAK,aAAa,KAAK;QAC1C,OAAO;IACT;IAEA,IAAI,WAAW,IAAI,KAAK,WAAW,KAAK;QACtC,OAAO;IACT;IAEA,OAAO;AACT;AAGO,SAAS,gBAAgB,OAAe;IAC7C,IAAI,UAAU,IAAI;QAChB,OAAO,GAAG,QAAQ,CAAC,CAAC;IACtB;IACA,MAAM,UAAU,KAAK,KAAK,CAAC,UAAU;IACrC,MAAM,mBAAmB,UAAU;IACnC,OAAO,GAAG,QAAQ,EAAE,EAAE,iBAAiB,CAAC,CAAC;AAC3C;AAGO,SAAS;IACd,OAAO,CAAC,QAAQ,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,MAAM,CAAC,GAAG,IAAI;AAC3E;AAGO,SAAS,qBAAqB,WAAoB,KAAK;IAC5D,wCAAmC,OAAO;;;IAE1C,MAAM;IASN,IAAI;AAQN;AAGO,SAAS;IACd,wCAAmC;;;AAErC;AAGO,SAAS;IACd,cAAc,4BAA4B;IAC1C,OAAO,qBAAqB;AAC9B;AAGO,SAAS,mBAAmB,QAAgB;IACjD,wCAAmC,OAAO;;;IAE1C,MAAM;IAGN,MAAM;AAER;AAGO,SAAS,oBAAoB,QAAgB;IAClD,wCAAmC;;;IAEnC,MAAM;IACN,MAAM;AAMR;AAGO,SAAS;IACd,wCAAmC;;;AAErC;AAGO,SAAS,sBAAsB,QAAgB;IACpD,wCAAmC;;;IAEnC,MAAM;IAGN,MAAM;IACN,MAAM;AAER;AAGO,SAAS,oBAAoB,KAAa,EAAE,KAAa;IAC9D,IAAI,UAAU,GAAG,OAAO;IACxB,OAAO,KAAK,KAAK,CAAC,AAAC,QAAQ,QAAS;AACtC;AAGO,SAAS,iBAAiB,IAAU;IACzC,MAAM,aAAa;QACjB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,OAAO,WAAW,QAAQ,CAAC,KAAK,IAAI;AACtC;AAGO,SAAS,eAAe,KAAa;IAC1C,IAAI,UAAU,GAAG,OAAO;IAExB,MAAM,IAAI;IACV,MAAM,QAAQ;QAAC;QAAS;QAAM;QAAM;KAAK;IACzC,MAAM,IAAI,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,SAAS,KAAK,GAAG,CAAC;IAEhD,OAAO,KAAK,KAAK,CAAC,QAAQ,KAAK,GAAG,CAAC,GAAG,KAAK,OAAO,MAAM,MAAM,KAAK,CAAC,EAAE;AACxE;AAGO,SAAS;IACd,OAAO,QAAQ,GAAG,CAAC,iBAAiB,IAAI;AAC1C;AAGO,SAAS,YAAY,QAAgB;IAC1C,MAAM,YAAY;IAClB,OAAO,SAAS,UAAU,CAAC,CAAC,CAAC,EAAE,WAAW;AAC5C"}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/components/survey/ClientSurveyRedirect.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { hasCompletedSurvey, renewSessionId } from '@/lib/utils';\nimport type { Survey } from '@/lib/types';\n\ninterface ClientSurveyRedirectProps {\n  surveys: Survey[];\n}\n\nexport function ClientSurveyRedirect({ surveys }: ClientSurveyRedirectProps) {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const isNewSession = searchParams.get('new') === 'true';\n\n  useEffect(() => {\n    // If user wants a new session (clicked \"Take Another Survey\")\n    if (isNewSession) {\n      // Clear completed surveys to allow retaking\n      if (typeof window !== 'undefined') {\n        localStorage.removeItem('completed_surveys');\n      }\n      // Note: renewSessionId() is not needed here as session was already ended\n      // A new session will be created automatically when the survey loads\n    }\n\n    // Find the first survey that hasn't been completed\n    const availableSurvey = surveys.find(survey => !hasCompletedSurvey(survey.id));\n\n    if (availableSurvey) {\n      // Redirect to the first uncompleted survey\n      setTimeout(() => {\n        router.push(`/survey/${availableSurvey.id}`);\n      }, 100);\n    } else if (surveys.length > 0 && isNewSession) {\n      // If new session requested and surveys exist, go to first one (allow retake)\n      setTimeout(() => {\n        router.push(`/survey/${surveys[0].id}`);\n      }, 100);\n    } else {\n      // All surveys completed, refresh to show \"all completed\" message\n      router.refresh();\n    }\n  }, [surveys, router, isNewSession]);\n\n  // Show loading while redirecting\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 via-pink-50 to-red-50\">\n      <div className=\"text-center max-w-md px-6\">\n        <div className=\"text-6xl mb-4 heart-pulse\">ðŸ’–</div>\n        <p className=\"text-lg text-muted-foreground mb-2\">Loading survey...</p>\n        <p className=\"text-sm text-muted-foreground\">\n          Found {surveys.length} active survey{surveys.length !== 1 ? 's' : ''}\n        </p>\n        {surveys.length === 0 && (\n          <p className=\"text-xs text-red-500 mt-2\">\n            No surveys found. Please create one in the admin dashboard.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAWO,SAAS,qBAAqB,EAAE,OAAO,EAA6B;IACzE,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,eAAe,aAAa,GAAG,CAAC,WAAW;IAEjD,IAAA,kNAAS,EAAC;QACR,8DAA8D;QAC9D,IAAI,cAAc;YAChB,4CAA4C;YAC5C;;QAGA,yEAAyE;QACzE,oEAAoE;QACtE;QAEA,mDAAmD;QACnD,MAAM,kBAAkB,QAAQ,IAAI,CAAC,CAAA,SAAU,CAAC,IAAA,yIAAkB,EAAC,OAAO,EAAE;QAE5E,IAAI,iBAAiB;YACnB,2CAA2C;YAC3C,WAAW;gBACT,OAAO,IAAI,CAAC,CAAC,QAAQ,EAAE,gBAAgB,EAAE,EAAE;YAC7C,GAAG;QACL,OAAO,IAAI,QAAQ,MAAM,GAAG,KAAK,cAAc;YAC7C,6EAA6E;YAC7E,WAAW;gBACT,OAAO,IAAI,CAAC,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE,CAAC,EAAE,EAAE;YACxC,GAAG;QACL,OAAO;YACL,iEAAiE;YACjE,OAAO,OAAO;QAChB;IACF,GAAG;QAAC;QAAS;QAAQ;KAAa;IAElC,iCAAiC;IACjC,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;8BAA4B;;;;;;8BAC3C,8OAAC;oBAAE,WAAU;8BAAqC;;;;;;8BAClD,8OAAC;oBAAE,WAAU;;wBAAgC;wBACpC,QAAQ,MAAM;wBAAC;wBAAe,QAAQ,MAAM,KAAK,IAAI,MAAM;;;;;;;gBAEnE,QAAQ,MAAM,KAAK,mBAClB,8OAAC;oBAAE,WAAU;8BAA4B;;;;;;;;;;;;;;;;;AAOnD"}}]
}