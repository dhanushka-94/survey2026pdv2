{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n// Tailwind class name merger\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n// Format date for display\nexport function formatDate(date: string | Date): string {\n  const d = typeof date === 'string' ? new Date(date) : date;\n  return d.toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric'\n  });\n}\n\n// Format datetime for display\nexport function formatDateTime(date: string | Date): string {\n  const d = typeof date === 'string' ? new Date(date) : date;\n  return d.toLocaleString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit'\n  });\n}\n\n// Check if survey is currently active\nexport function isSurveyActive(\n  isActive: boolean,\n  startDate: string | null,\n  endDate: string | null\n): boolean {\n  if (!isActive) return false;\n\n  const now = new Date();\n\n  if (startDate && new Date(startDate) > now) {\n    return false;\n  }\n\n  if (endDate && new Date(endDate) < now) {\n    return false;\n  }\n\n  return true;\n}\n\n// Format time spent in seconds to readable format\nexport function formatTimeSpent(seconds: number): string {\n  if (seconds < 60) {\n    return `${seconds}s`;\n  }\n  const minutes = Math.floor(seconds / 60);\n  const remainingSeconds = seconds % 60;\n  return `${minutes}m ${remainingSeconds}s`;\n}\n\n// Generate session ID\nexport function generateSessionId(): string {\n  return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Get or create session ID from localStorage\nexport function getOrCreateSessionId(forceNew: boolean = false): string {\n  if (typeof window === 'undefined') return '';\n\n  const storageKey = 'survey_session_id';\n  \n  // If forceNew is true, always generate a new session ID\n  if (forceNew) {\n    const sessionId = generateSessionId();\n    localStorage.setItem(storageKey, sessionId);\n    return sessionId;\n  }\n\n  let sessionId = localStorage.getItem(storageKey);\n\n  if (!sessionId) {\n    sessionId = generateSessionId();\n    localStorage.setItem(storageKey, sessionId);\n  }\n\n  return sessionId;\n}\n\n// End current session (clear session ID)\nexport function endSession(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.removeItem('survey_session_id');\n}\n\n// Generate a new session ID and replace the old one\nexport function renewSessionId(): string {\n  endSession(); // First end the old session\n  return getOrCreateSessionId(true);\n}\n\n// Check if user has completed a survey\nexport function hasCompletedSurvey(surveyId: string): boolean {\n  if (typeof window === 'undefined') return false;\n\n  const completedSurveys = localStorage.getItem('completed_surveys');\n  if (!completedSurveys) return false;\n\n  const completed = JSON.parse(completedSurveys);\n  return completed.includes(surveyId);\n}\n\n// Mark survey as completed\nexport function markSurveyCompleted(surveyId: string): void {\n  if (typeof window === 'undefined') return;\n\n  const completedSurveys = localStorage.getItem('completed_surveys');\n  const completed = completedSurveys ? JSON.parse(completedSurveys) : [];\n\n  if (!completed.includes(surveyId)) {\n    completed.push(surveyId);\n    localStorage.setItem('completed_surveys', JSON.stringify(completed));\n  }\n}\n\n// Clear all completed surveys (useful for testing or allowing retakes)\nexport function clearCompletedSurveys(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.removeItem('completed_surveys');\n}\n\n// Clear specific survey completion (allow retake)\nexport function clearSurveyCompletion(surveyId: string): void {\n  if (typeof window === 'undefined') return;\n\n  const completedSurveys = localStorage.getItem('completed_surveys');\n  if (!completedSurveys) return;\n\n  const completed = JSON.parse(completedSurveys);\n  const filtered = completed.filter((id: string) => id !== surveyId);\n  localStorage.setItem('completed_surveys', JSON.stringify(filtered));\n}\n\n// Calculate percentage\nexport function calculatePercentage(value: number, total: number): number {\n  if (total === 0) return 0;\n  return Math.round((value / total) * 100);\n}\n\n// Validate file type for media upload\nexport function isValidMediaFile(file: File): boolean {\n  const validTypes = [\n    'image/jpeg',\n    'image/jpg',\n    'image/png',\n    'image/gif',\n    'image/webp',\n    'video/mp4',\n    'video/webm',\n    'video/quicktime'\n  ];\n  return validTypes.includes(file.type);\n}\n\n// Format file size\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];\n}\n\n// Get admin path from env\nexport function getAdminPath(): string {\n  return process.env.ADMIN_SECRET_PATH || 'admin-x9QpK7';\n}\n\n// Validate admin path in URL\nexport function isAdminPath(pathname: string): boolean {\n  const adminPath = getAdminPath();\n  return pathname.startsWith(`/${adminPath}`);\n}\n\n// Device and Browser Detection\nexport interface DeviceInfo {\n  device_type: 'mobile' | 'tablet' | 'desktop';\n  browser: string;\n  os: string;\n}\n\nexport function getDeviceInfo(): DeviceInfo {\n  if (typeof window === 'undefined') {\n    return { device_type: 'desktop', browser: 'Unknown', os: 'Unknown' };\n  }\n\n  const ua = navigator.userAgent;\n  \n  // Detect device type\n  let device_type: 'mobile' | 'tablet' | 'desktop' = 'desktop';\n  if (/iPad|Android(?!.*Mobile)|Tablet/i.test(ua)) {\n    device_type = 'tablet';\n  } else if (/Mobile|iPhone|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(ua)) {\n    device_type = 'mobile';\n  }\n  \n  // Detect browser\n  let browser = 'Unknown';\n  if (/Edg\\//i.test(ua)) {\n    browser = 'Edge';\n  } else if (/Chrome/i.test(ua) && !/Chromium/i.test(ua)) {\n    browser = 'Chrome';\n  } else if (/Safari/i.test(ua) && !/Chrome/i.test(ua)) {\n    browser = 'Safari';\n  } else if (/Firefox/i.test(ua)) {\n    browser = 'Firefox';\n  } else if (/MSIE|Trident/i.test(ua)) {\n    browser = 'Internet Explorer';\n  } else if (/Opera|OPR/i.test(ua)) {\n    browser = 'Opera';\n  } else if (/Samsung/i.test(ua)) {\n    browser = 'Samsung Browser';\n  }\n  \n  // Detect OS\n  let os = 'Unknown';\n  if (/Windows/i.test(ua)) {\n    os = 'Windows';\n  } else if (/Mac OS X/i.test(ua) && !/iPhone|iPad|iPod/i.test(ua)) {\n    os = 'macOS';\n  } else if (/iPhone|iPad|iPod/i.test(ua)) {\n    os = 'iOS';\n  } else if (/Android/i.test(ua)) {\n    os = 'Android';\n  } else if (/Linux/i.test(ua)) {\n    os = 'Linux';\n  } else if (/CrOS/i.test(ua)) {\n    os = 'Chrome OS';\n  }\n  \n  return { device_type, browser, os };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/components/survey/ClientSurveyRedirect.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { hasCompletedSurvey, renewSessionId } from '@/lib/utils';\nimport type { Survey } from '@/lib/types';\n\ninterface ClientSurveyRedirectProps {\n  surveys: Survey[];\n}\n\nexport function ClientSurveyRedirect({ surveys }: ClientSurveyRedirectProps) {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const isNewSession = searchParams.get('new') === 'true';\n\n  useEffect(() => {\n    // If user wants a new session (clicked \"Take Another Survey\")\n    if (isNewSession) {\n      // Clear completed surveys to allow retaking\n      if (typeof window !== 'undefined') {\n        localStorage.removeItem('completed_surveys');\n      }\n      // Note: renewSessionId() is not needed here as session was already ended\n      // A new session will be created automatically when the survey loads\n    }\n\n    // Find the first survey that hasn't been completed\n    const availableSurvey = surveys.find(survey => !hasCompletedSurvey(survey.id));\n\n    if (availableSurvey) {\n      // Redirect to the first uncompleted survey\n      setTimeout(() => {\n        router.push(`/survey/${availableSurvey.id}`);\n      }, 100);\n    } else if (surveys.length > 0 && isNewSession) {\n      // If new session requested and surveys exist, go to first one (allow retake)\n      setTimeout(() => {\n        router.push(`/survey/${surveys[0].id}`);\n      }, 100);\n    } else {\n      // All surveys completed, refresh to show \"all completed\" message\n      router.refresh();\n    }\n  }, [surveys, router, isNewSession]);\n\n  // Show loading while redirecting\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 via-pink-50 to-red-50\">\n      <div className=\"text-center max-w-md px-6\">\n        <div className=\"text-6xl mb-4 heart-pulse\">ðŸ’–</div>\n        <p className=\"text-lg text-muted-foreground mb-2\">Loading survey...</p>\n        <p className=\"text-sm text-muted-foreground\">\n          Found {surveys.length} active survey{surveys.length !== 1 ? 's' : ''}\n        </p>\n        {surveys.length === 0 && (\n          <p className=\"text-xs text-red-500 mt-2\">\n            No surveys found. Please create one in the admin dashboard.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAWO,SAAS,qBAAqB,EAAE,OAAO,EAA6B;;IACzE,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,eAAe,IAAA,wJAAe;IACpC,MAAM,eAAe,aAAa,GAAG,CAAC,WAAW;IAEjD,IAAA,0KAAS;0CAAC;YACR,8DAA8D;YAC9D,IAAI,cAAc;gBAChB,4CAA4C;gBAC5C,wCAAmC;oBACjC,aAAa,UAAU,CAAC;gBAC1B;YACA,yEAAyE;YACzE,oEAAoE;YACtE;YAEA,mDAAmD;YACnD,MAAM,kBAAkB,QAAQ,IAAI;kEAAC,CAAA,SAAU,CAAC,IAAA,4IAAkB,EAAC,OAAO,EAAE;;YAE5E,IAAI,iBAAiB;gBACnB,2CAA2C;gBAC3C;sDAAW;wBACT,OAAO,IAAI,CAAC,CAAC,QAAQ,EAAE,gBAAgB,EAAE,EAAE;oBAC7C;qDAAG;YACL,OAAO,IAAI,QAAQ,MAAM,GAAG,KAAK,cAAc;gBAC7C,6EAA6E;gBAC7E;sDAAW;wBACT,OAAO,IAAI,CAAC,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE,CAAC,EAAE,EAAE;oBACxC;qDAAG;YACL,OAAO;gBACL,iEAAiE;gBACjE,OAAO,OAAO;YAChB;QACF;yCAAG;QAAC;QAAS;QAAQ;KAAa;IAElC,iCAAiC;IACjC,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;8BAA4B;;;;;;8BAC3C,6LAAC;oBAAE,WAAU;8BAAqC;;;;;;8BAClD,6LAAC;oBAAE,WAAU;;wBAAgC;wBACpC,QAAQ,MAAM;wBAAC;wBAAe,QAAQ,MAAM,KAAK,IAAI,MAAM;;;;;;;gBAEnE,QAAQ,MAAM,KAAK,mBAClB,6LAAC;oBAAE,WAAU;8BAA4B;;;;;;;;;;;;;;;;;AAOnD;GApDgB;;QACC,kJAAS;QACH,wJAAe;;;KAFtB"}},
    {"offset": {"line": 371, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/components/survey/ClearHistoryButton.tsx"],"sourcesContent":["'use client';\n\nexport function ClearHistoryButton() {\n  const handleClear = () => {\n    localStorage.removeItem('completed_surveys');\n    window.location.reload();\n  };\n\n  return (\n    <button\n      onClick={handleClear}\n      className=\"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover transition-colors text-sm font-medium\"\n    >\n      ðŸ”„ Clear History & Start Fresh\n    </button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAEO,SAAS;IACd,MAAM,cAAc;QAClB,aAAa,UAAU,CAAC;QACxB,OAAO,QAAQ,CAAC,MAAM;IACxB;IAEA,qBACE,6LAAC;QACC,SAAS;QACT,WAAU;kBACX;;;;;;AAIL;KAdgB"}}]
}