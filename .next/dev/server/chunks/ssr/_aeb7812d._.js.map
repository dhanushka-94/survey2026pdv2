{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/lib/supabase/admin.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\n\nif (!supabaseUrl || !supabaseServiceRoleKey) {\n  throw new Error('Missing Supabase service role environment variables');\n}\n\n// Admin client with service role key (bypasses RLS)\n// Use ONLY in server-side code, NEVER expose to client\nexport const supabaseAdmin = createClient(supabaseUrl, supabaseServiceRoleKey, {\n  auth: {\n    persistSession: false,\n    autoRefreshToken: false,\n  },\n});\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM,yBAAyB,QAAQ,GAAG,CAAC,yBAAyB;AAEpE,IAAI,CAAC,eAAe,CAAC,wBAAwB;IAC3C,MAAM,IAAI,MAAM;AAClB;AAIO,MAAM,gBAAgB,IAAA,8LAAY,EAAC,aAAa,wBAAwB;IAC7E,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;IACpB;AACF"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/actions/surveys.ts"],"sourcesContent":["'use server';\n\nimport { revalidatePath } from 'next/cache';\nimport { supabaseAdmin } from '@/lib/supabase/admin';\nimport type { Survey, SurveyFormData } from '@/lib/types';\n\nexport async function getSurveys() {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .select(`\n        *,\n        categories (count),\n        questions (count),\n        responses (count)\n      `)\n      .order('created_at', { ascending: false });\n\n    if (error) throw error;\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Get surveys error:', error);\n    return { success: false, error: 'Failed to fetch surveys' };\n  }\n}\n\nexport async function getSurvey(id: string) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .select(`\n        *,\n        categories (\n          *,\n          questions (*)\n        )\n      `)\n      .eq('id', id)\n      .single();\n\n    if (error) throw error;\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Get survey error:', error);\n    return { success: false, error: 'Failed to fetch survey' };\n  }\n}\n\nexport async function createSurvey(formData: SurveyFormData) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .insert([\n        {\n          title: formData.title,\n          description: formData.description || null,\n          is_active: formData.is_active,\n          start_date: formData.start_date || null,\n          end_date: formData.end_date || null,\n        },\n      ])\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    return { success: true, data };\n  } catch (error) {\n    console.error('Create survey error:', error);\n    return { success: false, error: 'Failed to create survey' };\n  }\n}\n\nexport async function updateSurvey(id: string, formData: Partial<SurveyFormData>) {\n  try {\n    const updateData: any = {};\n    \n    if (formData.title !== undefined) updateData.title = formData.title;\n    if (formData.description !== undefined) updateData.description = formData.description || null;\n    if (formData.is_active !== undefined) updateData.is_active = formData.is_active;\n    if (formData.start_date !== undefined) updateData.start_date = formData.start_date || null;\n    if (formData.end_date !== undefined) updateData.end_date = formData.end_date || null;\n\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .update(updateData)\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    revalidatePath(`/[admin]/surveys/${id}`);\n    return { success: true, data };\n  } catch (error) {\n    console.error('Update survey error:', error);\n    return { success: false, error: 'Failed to update survey' };\n  }\n}\n\nexport async function deleteSurvey(id: string) {\n  try {\n    const { error } = await supabaseAdmin\n      .from('surveys')\n      .delete()\n      .eq('id', id);\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    return { success: true };\n  } catch (error) {\n    console.error('Delete survey error:', error);\n    return { success: false, error: 'Failed to delete survey' };\n  }\n}\n\nexport async function toggleSurveyStatus(id: string, isActive: boolean) {\n  try {\n    const { data, error } = await supabaseAdmin\n      .from('surveys')\n      .update({ is_active: isActive })\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) throw error;\n\n    revalidatePath('/[admin]/surveys');\n    return { success: true, data };\n  } catch (error) {\n    console.error('Toggle survey status error:', error);\n    return { success: false, error: 'Failed to toggle survey status' };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/.next-internal/server/app/%5Badmin%5D/surveys/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logoutAdmin as '0044c53403e3e6604193e2aa1c0d11d56084a09ed0'} from 'ACTIONS_MODULE0'\nexport {checkAdminSession as '00b5af0f019f07563997cf748ee8535a9b5066dce2'} from 'ACTIONS_MODULE0'\nexport {getAdminPath as '00e3fdbd53c91de81a3ecacf9c1bcec97e0f099327'} from 'ACTIONS_MODULE0'\nexport {loginAdmin as '4027a64e0dccf3631de50036c8fe6a8b8163861436'} from 'ACTIONS_MODULE0'\nexport {getSurveys as '00ee61176fd1ce9dd9bbe5ebcd46ef5009a2aeb479'} from 'ACTIONS_MODULE1'\nexport {createSurvey as '405b5c6f81d49ce5f4d5ac91c1a80fc9c41984ba0c'} from 'ACTIONS_MODULE1'\nexport {getSurvey as '409ea891199aef9c726d2008793c2f1494a2ea4528'} from 'ACTIONS_MODULE1'\nexport {deleteSurvey as '40a51905bbba375e10727af3af66eff74326aaf293'} from 'ACTIONS_MODULE1'\nexport {toggleSurveyStatus as '6058276b6aeea1adfddfc94ad1a11ced5f30bf9cad'} from 'ACTIONS_MODULE1'\nexport {updateSurvey as '60b32d01d78c3fbd5337100d854341b71b93d794d9'} from 'ACTIONS_MODULE1'\nexport {toggleSurveyStatus as '6058276b6aeea1adfddfc94ad1a11ced5f30bf9cad'} from 'ACTIONS_MODULE1'\nexport {deleteSurvey as '40a51905bbba375e10727af3af66eff74326aaf293'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AAIA"}}]
}