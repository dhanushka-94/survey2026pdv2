{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/actions/auth.ts"],"sourcesContent":["'use server';\n\nimport { cookies } from 'next/headers';\nimport { redirect } from 'next/navigation';\nimport type { AdminSession } from '@/lib/types';\n\nconst ADMIN_PASSWORD = process.env.ADMIN_PASSWORD || 'admin123';\nconst ADMIN_PATH = process.env.ADMIN_SECRET_PATH || 'admin-x9QpK7';\nconst SESSION_DURATION = 24 * 60 * 60 * 1000; // 24 hours\n\nexport async function loginAdmin(password: string) {\n  try {\n    // Validate password\n    if (password !== ADMIN_PASSWORD) {\n      return { success: false, error: 'Invalid password' };\n    }\n\n    // Create session\n    const session: AdminSession = {\n      authenticated: true,\n      expiresAt: Date.now() + SESSION_DURATION,\n    };\n\n    // Set httpOnly cookie\n    const cookieStore = await cookies();\n    cookieStore.set('admin_session', JSON.stringify(session), {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      sameSite: 'lax',\n      maxAge: SESSION_DURATION / 1000,\n      path: '/',\n    });\n\n    return { success: true };\n  } catch (error) {\n    console.error('Login error:', error);\n    return { success: false, error: 'An error occurred during login' };\n  }\n}\n\nexport async function logoutAdmin() {\n  const cookieStore = await cookies();\n  cookieStore.delete('admin_session');\n  redirect(`/${ADMIN_PATH}`);\n}\n\nexport async function checkAdminSession(): Promise<boolean> {\n  try {\n    const cookieStore = await cookies();\n    const adminSession = cookieStore.get('admin_session');\n\n    if (!adminSession) {\n      return false;\n    }\n\n    const session: AdminSession = JSON.parse(adminSession.value);\n    const now = Date.now();\n\n    if (session.expiresAt < now) {\n      // Session expired\n      cookieStore.delete('admin_session');\n      return false;\n    }\n\n    return session.authenticated;\n  } catch (error) {\n    console.error('Session check error:', error);\n    return false;\n  }\n}\n\nexport async function getAdminPath(): Promise<string> {\n  return ADMIN_PATH;\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AAAA;;;;;AAGA,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AACrD,MAAM,aAAa,QAAQ,GAAG,CAAC,iBAAiB,IAAI;AACpD,MAAM,mBAAmB,KAAK,KAAK,KAAK,MAAM,WAAW;AAElD,eAAe,WAAW,QAAgB;IAC/C,IAAI;QACF,oBAAoB;QACpB,IAAI,aAAa,gBAAgB;YAC/B,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAmB;QACrD;QAEA,iBAAiB;QACjB,MAAM,UAAwB;YAC5B,eAAe;YACf,WAAW,KAAK,GAAG,KAAK;QAC1B;QAEA,sBAAsB;QACtB,MAAM,cAAc,MAAM,IAAA,0IAAO;QACjC,YAAY,GAAG,CAAC,iBAAiB,KAAK,SAAS,CAAC,UAAU;YACxD,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,mBAAmB;YAC3B,MAAM;QACR;QAEA,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAiC;IACnE;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,MAAM,CAAC;IACnB,IAAA,iMAAQ,EAAC,CAAC,CAAC,EAAE,YAAY;AAC3B;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,0IAAO;QACjC,MAAM,eAAe,YAAY,GAAG,CAAC;QAErC,IAAI,CAAC,cAAc;YACjB,OAAO;QACT;QAEA,MAAM,UAAwB,KAAK,KAAK,CAAC,aAAa,KAAK;QAC3D,MAAM,MAAM,KAAK,GAAG;QAEpB,IAAI,QAAQ,SAAS,GAAG,KAAK;YAC3B,kBAAkB;YAClB,YAAY,MAAM,CAAC;YACnB,OAAO;QACT;QAEA,OAAO,QAAQ,aAAa;IAC9B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO;IACT;AACF;AAEO,eAAe;IACpB,OAAO;AACT;;;IA/DsB;IA8BA;IAMA;IAyBA;;AA7DA,+OAAA;AA8BA,+OAAA;AAMA,+OAAA;AAyBA,+OAAA"}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///Users/dhanushka/Desktop/survey/src/app/%5Badmin%5D/layout.tsx"],"sourcesContent":["import type { Metadata } from 'next';\nimport { redirect } from 'next/navigation';\nimport { getAdminPath } from '@/actions/auth';\n\nexport const metadata: Metadata = {\n  title: 'Admin Dashboard - Survey System',\n  description: 'Admin dashboard for managing surveys',\n};\n\nexport default async function AdminLayout({\n  children,\n  params,\n}: {\n  children: React.ReactNode;\n  params: Promise<{ admin: string }>;\n}) {\n  const { admin } = await params;\n  const expectedPath = await getAdminPath();\n\n  // Verify the admin path matches\n  if (admin !== expectedPath) {\n    redirect('/');\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {children}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AACA;AAAA;AACA;;;;AAEO,MAAM,WAAqB;IAChC,OAAO;IACP,aAAa;AACf;AAEe,eAAe,YAAY,EACxC,QAAQ,EACR,MAAM,EAIP;IACC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM;IACxB,MAAM,eAAe,MAAM,IAAA,sIAAY;IAEvC,gCAAgC;IAChC,IAAI,UAAU,cAAc;QAC1B,IAAA,iMAAQ,EAAC;IACX;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACZ;;;;;;AAGP"}}]
}